---
import HeadSEO from "@/components/core/HeadSEO.astro";

import { docconfig, LOCALE, SITE } from "config";

import type { BaseLayoutProps } from "@/lib/types";
import { capitalizeFirstLetter } from "@/lib/utils";
import Header from "@/components/core/Header.astro";
import BlobBackground from "@/components/core/BlobBackground.astro";
import Copy from "@/components/core/Copy.astro";
import MainContent from "@/components/docs/MainContent.astro";
import SideNavMenu from "@/components/docs/SideNavMenu.astro";
import ScrollArea from "@/components/ui/ScrollArea.astro";
import TableofContent from "@/components/docs/TableofContents.astro";

const {
  image,
  imageAlt,
  contentType,
  title,
  author,
  pubDatetime,
  modDatetime,
  description,
  draft,
  tags,
  hide_breadcrumbs,
  hide_toc,
  hide_sidenav,
  headings,
} = Astro.props as BaseLayoutProps;
---

<html lang=`${LOCALE.lang ?? "en"}`>
  <head>
    <HeadSEO
      title=`${title ? capitalizeFirstLetter(title) : SITE.title}`
      description={description}
      image={image}
      imageAlt={imageAlt}
      contentType={contentType}
    />
  </head>

  <body>
    <BlobBackground />
    <main class="flex flex-col items-center">
      <Copy />
      <Header />
      <div class="flex h-[calc(100dvh-1px-3.5rem)] w-full">
        <!-- Column 1 -->
        <div class="w-1/5 h-full overflow-y-scroll">
          <SideNavMenu />
          <!-- <SideNavMenu items={menu} level={0} /> -->
        </div>

        <!-- Column 2 -->
        <div class="w-3/5 h-full overflow-y-scroll">
          <MainContent
            title={title}
            author={author}
            pubDatetime={pubDatetime}
            modDatetime={modDatetime}
            description={description}
            draft={draft}
            tags={tags}
            hide_breadcrumbs={hide_breadcrumbs}
            headings={headings}
          >
            <slot />
          </MainContent>
        </div>

        <!-- Column 3 -->
        <div class="w-1/5 h-full overflow-y-scroll">
          <TableofContent {headings} />
        </div>
      </div>
    </main>
  </body>
</html>

<!-- <div
  class="flex flex-row flex-1 w-full sticky top-[calc(1px+3.5rem)] h-[calc(100dvh-1px-3.5rem)]"
>
  <div
    class={`hidden md:flex w-full ${hide_toc && hide_sidenav ? "w-screen" : "md:w-1/4 lg:w-1/5"}`}
  >
    <SideNavMenu items={menu} level={0} />
  </div>
  <div
    class=`flex flex-col w-full ${hide_toc && hide_sidenav ? "" : "md:w-3/4 lg:w-3/5"}`
  >
    <MainContent
      title={title}
      author={author}
      pubDatetime={pubDatetime}
      modDatetime={modDatetime}
      description={description}
      draft={draft}
      tags={tags}
      hide_breadcrumbs={hide_breadcrumbs}
      headings={headings}
    >
      <slot />
    </MainContent>
  </div>
  <div
    class={`py-4 hidden lg:flex max-h-screen sticky ${hide_toc && hide_sidenav ? "" : "px-6 lg:w-1/5"}`}
  >
    <ScrollArea class="">
      {
        !docconfig.hide_table_of_contents && !hide_toc && (
          <TableofContent {headings} />
        )
      }
    </ScrollArea>
  </div>
</div> -->
